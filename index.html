<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="index.css" />
  <link rel="icon" href="./favicon.ico" />

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap');
  </style>
</head>

<body>
  <p id="subs"></p>
  <div id="startup">
    <header>
      <p id="webTitle">About Elvis</p>
    </header>
    <div id="startBody">
      <div id="startText">
        <h1>Meet Elvis</h1>
        <p>Chat with Alex, Elvis's colleague, to learn more about him</p>
        <button id="newBtn">Start Chat<div id="loader"></div></button>
        <button id="startBtn">Start Session</button>
      </div>
      <img
        src="https://images.unsplash.com/photo-1565728744382-61accd4aa148?q=80&w=2073&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D">
    </div>
  </div>
  <div id="main" style="display: none;">
    <p style="display:none;" id="badcode">beginning</p>
    <video class="bigVid" id="mediaElement" autoplay></video>

    <div id="statusBlock">
      <label style="display: none;">
        AvatarID
        <input id="avatarID" type="text" value="Wayne_20240711" />
      </label>

      <label style="display: none;">
        VoiceID
        <input id="voiceID" type="text" />
      </label>

      <label for="languageDrop">
        <select name="languageDrop" id="languageDrop">
          <option value="Chinese">中文</option>
          <option value="English">English</option>
          <option value="Japanese">日文</option>
          <option value="German">Deutsch</option>
          <option value="French">Français</option>
          <option value="Spanish">Español</option>
          <option value="Italian">Italiano</option>
        </select>
      </label>
      <input id="taskInput" placeholder="想了解 Elvis 什麼呢？" type="text" />
      <div id="buttonSwitch">
        <button id="speachBtn"><img width="25%" src="https://cdn-icons-png.flaticon.com/128/709/709682.png"></button>
        <button id="talkBtn">Send</button>
        <button id="endSpeech"><img width="25%"
            src="https://cdn-icons-png.flaticon.com/128/10413/10413984.png"></button>
      </div>
      <button style="display: none;" id="repeatBtn">Repeat</button>
      <button style="display: none;" id="closeBtn">Close</button>
    </div>

    <p style="color: yellow; background-color: rgb(0,0,0,0.3); padding: 0.5vw;" id="status"></p>
  </div>

  <script type="module" src="index.js"></script>
  <script type="module" src="buttons.js"></script>
  <script>
    // 長按空白鍵錄音，放開送出
    let spaceKeyPressed = false;

    document.addEventListener('keydown', function (event) {
      if (event.code !== 'Space' || spaceKeyPressed) return;

      // 正在打字時不攔截空白鍵
      const active = document.activeElement;
      if (active && (active.tagName === 'INPUT' || active.tagName === 'TEXTAREA')) return;

      // 只在聊天畫面生效
      const main = document.getElementById('main');
      if (!main || main.style.display === 'none') return;

      event.preventDefault();
      spaceKeyPressed = true;

      const speachBtn = document.getElementById('speachBtn');
      if (speachBtn) speachBtn.click();
    });

    document.addEventListener('keyup', function (event) {
      if (event.code !== 'Space' || !spaceKeyPressed) return;

      event.preventDefault();
      spaceKeyPressed = false;

      const endBtn = document.getElementById('endSpeech');
      if (endBtn) endBtn.click();
    });
  </script>
</body>

</html>
